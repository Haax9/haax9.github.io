<!DOCTYPE html>
<html lang="">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.48" />

    
    
    

<title>Best security practices for WordPress installations • Haax - Personal Blog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Best security practices for WordPress installations"/>
<meta name="twitter:description" content="If you want to set up your own website but you are not an expert, you may have seen the word &ldquo;Wordpress&rdquo; spread. It is a CMS (Content Management System) to help in the the creation of a website. Basically, it facilitates creation and management by providing a ready-to-use interface. Now all you have to do is customize your site and write your articles! No need to write code (even if it is possible to search and modify manually) !

"/>

<meta property="og:title" content="Best security practices for WordPress installations" />
<meta property="og:description" content="If you want to set up your own website but you are not an expert, you may have seen the word &ldquo;Wordpress&rdquo; spread. It is a CMS (Content Management System) to help in the the creation of a website. Basically, it facilitates creation and management by providing a ready-to-use interface. Now all you have to do is customize your site and write your articles! No need to write code (even if it is possible to search and modify manually) !

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://haaxmax.github.io/en/articles/best-security-practice-wordpress-installation/" /><meta property="article:published_time" content="2018-03-31T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-03-31T00:00:00&#43;00:00"/><meta property="og:site_name" content="Haax - Personal Blog" />

    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">




<link rel="stylesheet" href="/css/hyde-hyde.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/print.min.css" media="print">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body >
        
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      
      
        <a href="https://haaxmax.github.io/en">
      
      
      <p class="site__description">
        <a href="https://haaxmax.github.io">
         Infosec articles &amp; CTF Writeups 
      </a>
      </p>
    </div>
    <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/en/articles/">
						<span>Articles</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/en/walkthroughs/">
						<span>Walkthroughs</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/en/writeups/">
						<span>Write-Ups</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/en/about/">
						<span>About</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

    <p>
      <section class="social">
	
	<a href="https://twitter.com/Haaxmax" target="blank"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://github.com/Haaxmax" target="blank"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://gitlab.com/Haax" target="blank"><i class="fab fa-gitlab fa-lg" aria-hidden="true"></i></a>
	
	
	
  &nbsp;<a href="https://www.root-me.org/Haax" target="blank" class="linklogo"><div class="rootme_logo logohover"></div></a>
  
	
  &nbsp;<a href="http://www.aperikube.fr" target="blank" class="linklogo"><div class="aperikube_logo logohover"></div></a>
  
	
	&nbsp;<a href="mailto:haax@mdamail.ch" target="blank"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a>
	
</section>

    </p>
    <div class="langSection">
      
      
      <a rel="alternate" href="/fr/articles/bonnes-pratiques-install-wordpress/" hreflang="fr" lang="fr" class="langLink">Français</a>
      <a rel="alternate" href="/fr/articles/bonnes-pratiques-install-wordpress/" hreflang="fr" lang="fr"><img src="/img/icons/logo_drapeau_france.png" alt="logo_fracne" class="logoFlag"/></a>
      </div>
    <p class="copyright">
      &copy; 2018 Haax.
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Some Rights Reserved</a>.
      <br/>Built with
      <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
      
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>Best security practices for WordPress installations</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Mar 31, 2018
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/articles">ARTICLES</a>
              •
          
              <a class="badge badge-category" href="/categories/posts">POSTS</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/awareness">awareness</a>
           
      
          <a class="badge badge-tag" href="/tags/security">security</a>
           
      
          <a class="badge badge-tag" href="/tags/privacy">privacy</a>
           
      
          <a class="badge badge-tag" href="/tags/good-practices">good practices</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 11 min read
</div>


  </header>
  <div class="post">
    <p>If you want to set up your own website but you are not an expert, you may have seen the word &ldquo;Wordpress&rdquo; spread. It is a CMS (Content Management System) to help in the the creation of a website. Basically, it facilitates creation and management by providing a ready-to-use interface. Now all you have to do is customize your site and write your articles! No need to write code (even if it is possible to search and modify manually) !</p>

<p></p>

<p>However, some features which can be dangerous for the security of your website are by default left enabled&hellip; There are simple ways to patch this and improve the security of a WordPress site. What follows is not purely technical, but some additional research may be needed to understand the whole picture. The purpose of this article is to group the various things to modify, the various techniques that I found on Internet in order to learn why this is dangerous, but especially how to be protected by simple modifications!</p>

<h2 id="context-state-of-the-art">Context &amp; State of the art</h2>

<p>First, let&rsquo;s set up a frame for this post with some figures. Wordpresss, it&rsquo;s :
<ul>
    <li>Almost 25% of websites and blog you can visit everyday</li>
    <li>More than 70.000.000 blogs</li>
    <li>44.000 plugins</li>
    <li>Available in 56 languages</li>
    <li>82.000.000 new posts every month !</li>
</ul>
In other words, it is currently an important part of the known web. It means that Wordpres websites are also the most targeted websites by malicious users, trying to steal information, break in&hellip; And unfortunately, in order to be as versatile as possible, a WordPress installation leaves features enabled&hellip;</p>

<h2 id="limit-information-leak">Limit information leak</h2>

<p>One of the most important things as an attacker is to get as much information about your target as possible. There are various simple ways to retrieve all kinds of information and it turns out that WordPress lets some things pass at this level. It is therefore important to know these methods and how to correct these problems.</p>

<h3 id="wordpress-version">Wordpress version</h3>

<p>When searching for information on a website, one of the first information sought is the version of the site. Indeed, it is not uncommon to find vulnerabilities in older versions, which explains the regular updates. Thus, finding the version of the WordPress site will guide an attacker to attack the website. By default, it is possible to find the version of a WordPress website. One of the easiest ways to get the version of a website in WordPress is to use <strong>RSS feeds</strong>, accessible directly from the URL <a href="https://monsite.com/feed">https://monsite.com/feed</a>. A little check in the source code of the page reveals the information.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_version_1.png" alt="wpharden_version_1" class="imgSize"/></center></p>

<p>Removing this information is important. An effective solution for this is to modify one of the WordPress PHP files to add a small piece of code. This is the <strong>functions.php</strong> file available in the directory <em><a href="https://monsite.com/wp-includes/">https://monsite.com/wp-includes/</a></em>. We&rsquo;ll add the following code.</p>

<pre><code class="language-php">// Remove WP version from feed
function remove_wp_version() {
return '';
}
add_filter('the_generator', 'remove_wp_version');
</code></pre>

<p>Thus, no more version leak trouble ! However, I would like to add something. It is necessary to focus on regular updates and to apply them if you can. These updates allow you to add content but also to patch vulnerabilities and so, to enforce your security.</p>

<h3 id="robots-txt-file">robots.txt file</h3>

<p>The robots.txt file is a public file used by the various robots that browse the internet to reference your website. As a public file, it is important to limit information, and especially useless information, because it can be seen by any user going on the page <em><a href="http://monsite.com/robots.txt">http://monsite.com/robots.txt</a></em>. This file allows robots to specify what they should index and reference and what they should not.</p>

<p>As an example, here is the content of the robots.txt file for the site <a href="https://haax.fr">https://haax.fr</a>.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_robots_1.png" alt="wpharden_robots_1" class="imgSize"/></center></p>

<p>&ldquo;Disallow&rdquo; clauses tell robots to not index what&rsquo;s behind. So, I ask robots to not index my administration interface (wp-admin), the different PHP configuration files of the website, etc&hellip;.</p>

<p>However, I ask them to index the content of <em>/wp-content/uploads</em> because it is the directory containing pictures of the different posts. Thus, pictures will be referenced on the various search engines and this blog will be found by users.</p>

<p>The interest of explicitly specifying to robots not to index certain parts of your site is to prevent anyone from coming across unwanted pages (for example, the page connecting to the administration area) simply with search engines&hellip;</p>

<p>To illustrate what I just said, here is an example of websites that let Google index their login page to the administration area. It doesn&rsquo;t seem to be a lot, but it&rsquo;s just making it easier for people with bad intentions&hellip;.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_hidelogin_2.png" alt="wpharden_hidelogin_2" class="imgSize"/></center></p>

<h3 id="htaccess-file">.htaccess file</h3>

<p>The.htaccess file is a very important file for the security management of your website. It is located in the root folder of your website and allows you to set up different navigation rules that will be applied to each user who visits your site.</p>

<p>It is for example possible to force a redirection to a page, to prevent someone from accessing an area of the site, or simply deny access to some sensitive files.</p>

<p>It is therefore extremely important to prevent anyone from accessing this file. You can write a rule in your file that will prevent any user from accessing it. The following rule allows you to do this.</p>

<pre><code>##Deny access to all .htaccess files
&lt;files ~ &quot;^.*\.([Hh][Tt][Aa])&quot;&gt;
order allow,deny
deny from all
satisfy all
&lt;/files&gt;
</code></pre>

<p>So if someone tries to access the file, they will get the following result.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_htaccess_1.png" alt="wpharden_htaccess_1" class="imgSize"/></center></p>

<h3 id="users-enumeration">Users enumeration</h3>

<p>WordPress works with an authoring system. It is indeed possible to see all the articles published by an author by going to the page <em>/author/personname</em>. However, by default, we do not know the users&rsquo;s name.</p>

<p>As in most databases, WordPress works with a system of unique numbers called &ldquo;id&rdquo;, identifying each user. Thus, the first user created (and often the administrator..) has id 1. The second user has id 2, etc.</p>

<p>It is possible to list users by asking for example <em><a href="https://monsite.com?author=1">https://monsite.com?author=1</a></em>. Thus, the user will be redirected to the corresponding <em>/author/person</em>. Various tools exist to automate the enumeration process, but this is not the topic of this post.</p>

<p>It is therefore important to prevent a potential attacker from being able to list users of your website, because if it happens, it means that the attacker already has connection information. All he has to do is to find the password&hellip;</p>

<p>An easy solution is to redirect every user who tries to list to the home page. Redirections can be made by rules placed in the <strong>.htaccess</strong> file of your website. The following rules correspond to this need:</p>

<pre><code>##Avoid users enumeration and redirect to index
RewriteCond %{REQUEST_URI}  !^/wp-admin [NC]
RewriteCond %{QUERY_STRING} author=\d
RewriteRule (.*)        $1? [L,R=301]

##Redirect /author/
RedirectMatch 301 ^/author/ https://haax.fr/?
</code></pre>

<p>So if someone tries to list users of the website, they will automatically be redirected to the home page and will not have access to the information.</p>

<h3 id="useless-installation-files">Useless installation files</h3>

<p>Once your WordPress site is installed, some unnecessary files remain available on the website. It is important to identify the files to delete as they may reveal information to an attacker. The <strong>readme.html</strong> file is one of these files. This is a file in the root folder of your website explaining the procedure for installing a WordPress site, as well as other things not very useful. However, this file may also reveal the version of WordPress you are using. Thus, if your site is not up to date, it is possible that it presents known vulnerabilities. If an attacker becomes aware of this information, he can use one of these vulnerabilities against your website.</p>

<p>Here is an example of a website that did not delete the <strong>readme.html</strong> file.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_readme_1.png" alt="wpharden_readme_1" class="imgSize"/></center></p>

<p>We can see that this is a WordPress 3.0 website&hellip; A very old version, and therefore probably full of vulnerabilities. It is therefore important to delete this file. Once done, if someone tries to access the <em><a href="https://monsite.com/readme.html">https://monsite.com/readme.html</a></em> file, they will get the following result.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_readme_2.png" alt="wpharden_readme_2" class="imgSize"/></center></p>

<h3 id="directory-listing-access-to-wp-includes-folder">Directory Listing - Access to wp-includes folder</h3>

<p>Always in order to limit the information leak as much as possible, it is important to control what is accessible. We have seen thanks to the file <strong>robots.txt</strong> that it is possible to forbid robots to reference some parts of a website. However, these areas are still fully accessible to anyone who fetches them manually&hellip; For example, the <em>/wp-includes/</em> directory contains a whole bunch of configuration files.</p>

<p>So, if you try to access it manually and access is not restricted, you get the complete list of files.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_includes_2.png" alt="wpharden_includes_2" class="imgSize"/></center></p>

<p>Here again, it is possible to restrict access by writing a rule placed in the <strong>.htaccess</strong> file. We will simply deny any user access to the <em>/wp-includes/</em> directory as well as the files present here.</p>

<pre><code>##Block wp-includes folder and files
RewriteRule ^wp-admin/includes/ - [F,L]
RewriteRule !^wp-includes/ - [S=3]
RewriteRule ^wp-includes/[^/]+\.php$ - [F,L]
RewriteRule ^wp-includes/js/tinymce/langs/.+\.php$ - [F,L]
RewriteRule ^wp-includes/theme-compat/ - [F,L]
</code></pre>

<p>Thus, an attempt to access this directory now ends in failure.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_includes_3.png" alt="wpharden_includes_3" class="imgSize"/></center></p>

<h3 id="wp-config-php">WP-config.php</h3>

<p>The <strong>wp-config.php</strong> file is one of the most important configuration files for your website. In particular, it contains the connection information to your database. It is  imperative to block access to this file for any user coming from outside. Some researches on the internet and we find this kind of file in free access on some websites&hellip;</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_config_1.png" alt="wpharden_config_1" class="imgSize"/></center></p>

<p>Once again, the access restriction to this file can be done through a <strong>HTACCESS</strong> rule. We will simply specify that access to the file is forbidden, for everyone.</p>

<pre><code>&lt;files wp-config.php&gt;
order allow,deny
deny from all
&lt;/files&gt;
</code></pre>

<p>Result&hellip; Nothing!</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_config_2.png" alt="wpharden_config_2" class="imgSize"/></center></p>

<h2 id="limit-intrusion-risks">Limit intrusion risks</h2>

<h3 id="hide-the-admin-panel">Hide the admin panel</h3>

<p>By default, the login page to the wordpress administration area can be obtained through the following URL <em><a href="https://monsite.com/wp-admin">https://monsite.com/wp-admin</a></em></p>

<p>In concrete terms, this means that anyone can try to connect to your website with different login and passwords. An exposed administration interface is taking unnecessary risks. This is why it is important to change the default path to this interface.</p>

<p>Several solutions exist for this, but the easiest solution to implement is usin a plugin. Plugins such as <strong>WPS Hide Login</strong> allow you to simply modify the access URL to the administration area.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_hidelogin_1.png" alt="wpharden_hidelogin_2" class="imgSize"/></center></p>

<h3 id="xmlrpc-php-file">XMLRPC.php file</h3>

<p>Brute-force attacks are widespread on the Internet. The principle is very simple: you try to connect to a service by trying millions of possible login/password combinations and hoping to come across a good combination. The so-called <strong>XMLRPC</strong> attack is a known attack that allows an attacker to test several hundred login/password combinations on a WordPress site in a single request. By sending a large number of requests, the attacker has the possibility to test a very large number of combinations.</p>

<p>By default, any recent wordpress site is vulnerable to this attack, because the <strong>xmlrpc.php</strong> file is accessible to any user. To test if your site is vulnerable, nothing easier! Just try to access the file in your browser.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_xmlrpc_1.png" alt="wpharden_xmlrpc_2" class="imgSize"/></center></p>

<p>If the result is a blank page with the text &ldquo;<strong>XML-RPC server accepts POST requests only.</strong>&rdquo; then you&rsquo;re vulnerable. You should know that <strong>XMLRPC</strong> is not there for nothing, it is possible that your site uses this functionality. It is advisable to check the use of this feature before turning it off.</p>

<p>However, if you do not use it, it is important to prevent access to this file. Several solutions exist for this. A simple solution is to add a rule to your site&rsquo;s <strong>.htaccess</strong> file to prevent visitors from accessing the file.</p>

<p>The following rule can be added:</p>

<pre><code>##Block WordPress xmlrpc.php requests
&lt;Files xmlrpc.php&gt;
order deny,allow
deny from all
&lt;/Files&gt;
</code></pre>

<p>Once modified, a query on the <strong>xmlrpc.php</strong> file should return this:</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_xmlrpc_2.png" alt="wpharden_xmlrpc_2" class="imgSize"/></center></p>

<p>If this is the case, the file is no longer accessible, and therefore an attacker will no longer be able to exploit this vulnerability!</p>

<h3 id="limit-login-attempts">Limit login attempts</h3>

<p>By default, WordPress allows a user to attempt to log in with an infinite number of usernames and passwords. We have the same problem as in the previous paragraph, the site is vulnerable to bruteforce attacks. Even if the site is no longer vulnerable via XMLRPC, the login interface remains accessible and a malicious person might try to attack your website through this way.</p>

<p>It is therefore important to limit the number of login attempts per user. Once again, a good solution can be to use a plugin. There are several ways to do this. It is then possible to customize the maximum number of attempts desired.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_limitlogin_1.png" alt="wpharden_limitlogin_1" class="imgSize"/></center></p>

<h3 id="having-different-usernames-and-public-names">Having different usernames and public names</h3>

<p>By default, when you publish a post with Wordpress, the author&rsquo;s name is displayed on the post. And by default, the author you publish with is also the Wordpress account username. Therefore, publishing a post reveals your user name, thus giving information to a potential attacker. Fortunately, it is possible to use a nickname for each account, allowing you to change the name publicly displayed on your articles.</p>

<p><center><img src="/img/articles/bonnes-pratiques-install-wordpress/wpharden_username_1.png" alt="wpharden_username_1" class="imgSize"/></center></p>

<h2 id="final-word">Final word</h2>

<p>WordPress is a very interesting CMS, easy to learn and offering a multitude of features and possibilities. Undeniably, on the other hand, the system needs to be as versatile as possible to suit all uses. This implies default settings, values, files&hellip; Things that can endanger your website.</p>

<p>Taken individually, most of the points in this post are not extremely serious or compromising, but if you add them together, they can significantly weaken the security of your website. It is therefore important to know this kind of thing but also to remain active and attentive to what surrounds us, such as the discovery of vulnerabilities.</p>
  </div>
  

<div class="post--navigation post--navigation-single">
    
    <a href="/en/articles/password-reuse-threat/" class="post--navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">The password reuse threat</span>
    </a>
    
    
    <a href="/en/articles/internet-box-privacy/" class="post--navigation-next">
      <span class="navigation-tittle">Android Internet Box and Privacy - The iceberg summit</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
<script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"
  integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy"
  crossorigin="anonymous">
</script>


    
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        <script type="text/javascript">
            hljs.configure({languages: []});
            hljs.initHighlightingOnLoad();
        </script>
        
        



    



    </body>
</html>
