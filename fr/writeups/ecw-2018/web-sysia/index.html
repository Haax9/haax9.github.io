<!DOCTYPE html>
<html lang="">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.80.0" />

    
    
    

<title>ECW 2018 - Web - SysIA • Haax - Personal Blog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ECW 2018 - Web - SysIA"/>
<meta name="twitter:description" content="L’ECW 2018 est un challenge Jeopardy français organisé par le Pôle d’Excellence Cyber en partenariat avec la Région Bretagne, Airbus et Thales. SysIA est un challenge basé sur l&rsquo;exploitation d&rsquo;une LFI (Local File Inclusion) puis l&rsquo;utilisation du bash_history et de l&rsquo;utilitaire updatedb afin de trouver le flag."/>

<meta property="og:title" content="ECW 2018 - Web - SysIA" />
<meta property="og:description" content="L’ECW 2018 est un challenge Jeopardy français organisé par le Pôle d’Excellence Cyber en partenariat avec la Région Bretagne, Airbus et Thales. SysIA est un challenge basé sur l&rsquo;exploitation d&rsquo;une LFI (Local File Inclusion) puis l&rsquo;utilisation du bash_history et de l&rsquo;utilitaire updatedb afin de trouver le flag." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://haax9.github.io/fr/writeups/ecw-2018/web-sysia/" />
<meta property="article:published_time" content="2018-10-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-10-21T00:00:00+00:00" /><meta property="og:site_name" content="Haax - Personal Blog" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">




<link rel="stylesheet" href="/css/hyde-hyde.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/print.min.css" media="print">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body >
        
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      
      
          <a href="https://haax9.github.io">
          
          
          
          <div class="author-image">
            <img src="/img/icons/haax_logo.png" alt="Author Image" class="img--circle img--headshot element--center">
          </div>
          
          </a>
        
      <p class="site__description">
        <a href="https://haax9.github.io">
         Infosec articles &amp; CTF Writeups 
      </a>
      </p>
    </div>
    <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/fr/articles/">
						<span>Articles</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/walkthroughs/">
						<span>Walkthroughs</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/writeups/">
						<span>Write-Ups</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/about/">
						<span>À Propos</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/conferences/">
						<span>Conférences</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://cheatsheet.haax.fr">
						<span>Cheatsheet</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

    <p>
      <section class="social">
	
	<a href="https://twitter.com/Haax9_" target="blank"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://github.com/Haax9" target="blank"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://gitlab.com/Haax" target="blank"><i class="fab fa-gitlab fa-lg" aria-hidden="true"></i></a>
	
	
	
  &nbsp;<a href="https://www.root-me.org/Haax" target="blank" class="linklogo"><div class="rootme_logo logohover"></div></a>
  
	
  &nbsp;<a href="http://www.aperikube.fr" target="blank" class="linklogo"><div class="aperikube_logo logohover"></div></a>
  
	
	&nbsp;<a href="mailto:haax@mdamail.ch" target="blank"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://haax.fr/fr/index.xml" target="blank"><i class="fas fa-rss fa-lg" aria-hidden="true"></i></a>
	</section>

    </p>
    <div class="langSection">
      
      
      <a rel="alternate" href="/en/writeups/ecw-2018/web-sysia/" hreflang="en" lang="en" class="langLink">English</a>
      <a rel="alternate" href="/en/writeups/ecw-2018/web-sysia/" hreflang="en" lang="en"><img src="/img/icons/logo_drapeau_angleterre.png" alt="logo_angleterre" class="logoFlag"/></a>
      </div>
    <p class="copyright">
      &copy; 2023 Haax.
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Some Rights Reserved</a>.
      <br/>Built with
      <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
      
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>ECW 2018 - Web - SysIA</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Oct 21, 2018
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  <div class="post">
    <p>L’ECW 2018 est un challenge Jeopardy français organisé par le Pôle d’Excellence Cyber en partenariat avec la Région Bretagne, Airbus et Thales. SysIA est un challenge basé sur l&rsquo;exploitation d&rsquo;une LFI (Local File Inclusion) puis l&rsquo;utilisation du bash_history et de l&rsquo;utilitaire updatedb afin de trouver le flag.</p>
<p>Du 06/10 au 21/10 2018, il sert de pré-sélection pour l’épreuve finale de type Capture The Flag qui débutera le 21 novembre 2018 lors de la conférence de <!-- raw HTML omitted -->l’European Cyber Week<!-- raw HTML omitted --> à Rennes.</p>
<h2 id="découverte">Découverte</h2>
<p>Le challenge démarre avec l&rsquo;énoncé suivant :</p>
<pre><code>Notre jeune IA administrateur système continue de commettre des erreurs humaines.
Je suppose qu'il faut encore apprendre avant la production.
Mais nous ne pouvons pas nous permettre de la retarder encodre une fois!
</code></pre><p>De même, une première information donnée par les organisateurs : &ldquo;An easy good old PHP challenge ;)&rdquo; nous permet de fermer dès à présent certaines possibilités.</p>
<p>On arrive donc sur un site web parlant de &ldquo;deep learning&rdquo;</p>
<!-- raw HTML omitted -->
<p>Après une petite navigation sur les différentes pages, qui ne semblent être que des pages vitrine, on va faire un tour du côté du fichier &ldquo;robots.txt&rdquo; et on y trouve quelque chose de louche&hellip;</p>
<pre><code>https://web075-sysia.challenge-ecw.fr/robots.txt
</code></pre><!-- raw HTML omitted -->
<p>Ni une ni deux, on file sur la page non-indexée et on y trouve ceci.</p>
<!-- raw HTML omitted -->
<p>L&rsquo;expérience et les indications laissées par les organisateurs nous indiquent une route&hellip; Ca sent bon la LFI !</p>
<h2 id="lfi---exploitation">LFI - Exploitation</h2>
<p>Comme tout bon POC, on va tenter de prouver la présence d&rsquo;une vulnérabilité Local File Inclusion (LFI) en affichant le contenu du fichier &ldquo;/etc/passwd&rdquo; qui est normalement lisible.</p>
<pre><code>https://web075-sysia.challenge-ecw.fr/notinterestingfile.php?page=../../../../etc/passwd
</code></pre><!-- raw HTML omitted -->
<p>Bingo ! On a une jolie LFI. Maintenant&hellip; Qu&rsquo;est ce que nous cherchons ? Il est possible de lire certains fichiers sur le serveur, on va donc chercher à récupérer le maximum d&rsquo;informations.
Après quelques tests, on s&rsquo;oriente du côté du fichier contenant l&rsquo;historique des commandes exécutées par l&rsquo;utilisateur, le fichier &ldquo;bash_history&rdquo;, pouvant contenir de précieuses informations.
Etant dans un docker, on va aller fouiller du côté de l&rsquo;historique pour l&rsquo;utilisateur root.</p>
<pre><code>https://web075-sysia.challenge-ecw.fr/notinterestingfile.php?page=../../../../root/bash_history
</code></pre><!-- raw HTML omitted -->
<p>Afin de pouvoir lire correctement le contenu du fichier, on va directement dans les source de la page. Après un rapide coup d&rsquo;oeil sur le contenu de fichier, on remarque la présence d&rsquo;une séquence de 3 commandes intéressantes :</p>
<ul>
<li>locate flag.txt</li>
<li>updatedb</li>
<li>locate flag.txt</li>
</ul>
<!-- raw HTML omitted -->
<p>Petite subtilité que je connaissais pas, l&rsquo;utilitaire &ldquo;updatedb&rdquo; permet de mettre à jour la base de chemins connus et utilisés par locate. Ainsi, après quelques recherches, on apprend que le contenu de cette base est stocké dans le fichier &ldquo;/var/lib/mlocate/mlocate.db&rdquo;. Par conséquent.. On devrait trouver le chemin vers le fichier flag.txt. Afin d&rsquo;éviter de chercher à la main, on va chercher directement la chaine &ldquo;ECW&rdquo;.</p>
<pre><code>https://web075-sysia.challenge-ecw.fr/notinterestingfile.php?page=../../../../var/lib/mlocate/mlocate.db
</code></pre><!-- raw HTML omitted -->
<p>Bingo, on a un chemin !</p>
<h2 id="récupération-du-flag">Récupération du flag</h2>
<p>On peut donc via notre LFI aller lire directement le contenu du fichier flag.txt, et ainsi récupérer le flag du challenge.</p>
<pre><code>https://web075-sysia.challenge-ecw.fr/notinterestingfile.php?page=../../../../var/www/ECW/solution/web/lfi/flag.txt
</code></pre><!-- raw HTML omitted -->
<p>Au final, challenge assez simple présentant une LFI sans aucune restriction mais ayant la plus value d&rsquo;intégrer une exploitation un peu plus réaliste. Nice one ! :)</p>
<h2 id="références">Références</h2>
<ul>
<li><!-- raw HTML omitted -->Where is updatedb database located ?<!-- raw HTML omitted --></li>
</ul>
  </div>
  

<div class="post--navigation post--navigation-single">
    
    <a href="/fr/writeups/ecw-2017/web-path-through/" class="post--navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">ECW 2017 - Web - Path Through</span>
    </a>
    
    
    <a href="/fr/writeups/ecw-2018/web-troll-jsp/" class="post--navigation-next">
      <span class="navigation-tittle">ECW 2018 - Web - Troll.JSP</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GB7QC0EDF8', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"
  integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy"
  crossorigin="anonymous">
</script>


    
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        <script type="text/javascript">
            hljs.configure({languages: []});
            hljs.initHighlightingOnLoad();
        </script>
        
        



    



    </body>
</html>
